# üìò –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –æ—Ç Pull Request –¥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

## üéØ –¶–µ–ª—å
–°–º–µ—Ä–∂–∏—Ç—å –≤–∞—à—É —Ä–∞–±–æ—Ç—É –≤ main, —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã.

---

## –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Pull Request –∏ merge –≤ main

### 1.1 –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ GitHub

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://github.com/spqr-86/safety-incident-analyzer
```

### 1.2 –°–æ–∑–¥–∞–π—Ç–µ Pull Request

1. –í—ã —É–≤–∏–¥–∏—Ç–µ –∂–µ–ª—Ç—ã–π –±–∞–Ω–Ω–µ—Ä: **"claude/project-development-plan-Wf6gO had recent pushes"**
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"Compare & pull request"**

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
1. –ù–∞–∂–º–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É **"Pull requests"**
2. –ù–∞–∂–º–∏—Ç–µ –∑–µ–ª–µ–Ω—É—é –∫–Ω–æ–ø–∫—É **"New pull request"**
3. –í—ã–±–µ—Ä–∏—Ç–µ:
   - **base**: `main`
   - **compare**: `claude/project-development-plan-Wf6gO`

### 1.3 –ó–∞–ø–æ–ª–Ω–∏—Ç–µ PR

**Title** (–∑–∞–≥–æ–ª–æ–≤–æ–∫):
```
Add comprehensive evaluation system and expand dataset to 41 questions
```

**Description** (–æ–ø–∏—Å–∞–Ω–∏–µ):
```markdown
## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### Evaluation Framework
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 11 –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ (5 retrieval + 6 generation)
- LLM-as-a-Judge –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏
- CI/CD –≤ GitHub Actions —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–π

### Dataset
- –†–∞—Å—à–∏—Ä–µ–Ω golden dataset —Å 16 –¥–æ 41 –≤–æ–ø—Ä–æ—Å–æ–≤ (+156%)
- –î–æ–±–∞–≤–ª–µ–Ω–æ 25 –≤–æ–ø—Ä–æ—Å–æ–≤ –æ—Ç Perplexity (–∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è 2026)
- 3 —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–±–∞–∑–æ–≤—ã–µ/—Å—Ä–µ–¥–Ω–∏–µ/—Å–ª–æ–∂–Ω—ã–µ)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- Comprehensive development plan (6-phase roadmap)
- Quick start guide –∏ examples
- Phase 1 setup guide
- Local setup instructions

### –¢–µ—Å—Ç—ã
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ (100% pass)
- Demo —Å–∫—Ä–∏–ø—Ç –±–µ–∑ API –∫–ª—é—á–µ–π
- Utility scripts –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **Files changed**: ~22 —Ñ–∞–π–ª–∞
- **Lines added**: ~5000+ —Å—Ç—Ä–æ–∫
- **Commits**: 13 –∫–æ–º–º–∏—Ç–æ–≤
- **Dataset size**: 16 ‚Üí 41 –≤–æ–ø—Ä–æ—Å–æ–≤
- **Test coverage**: –í—Å–µ unit —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç ‚úÖ

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ merge:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å baseline evaluation
2. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–∑—é–º–µ
3. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å CI/CD (–¥–æ–±–∞–≤–∏—Ç—å GitHub Secrets)

## ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

- [x] –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [x] Unit —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [x] Dataset —Ä–∞—Å—à–∏—Ä–µ–Ω –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω
- [ ] Baseline evaluation (—Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–∏)
```

### 1.4 –°–æ–∑–¥–∞–π—Ç–µ –∏ —Å–º–µ—Ä–∂–∏—Ç–µ PR

1. –ù–∞–∂–º–∏—Ç–µ **"Create pull request"**
2. GitHub –ø–æ–∫–∞–∂–µ—Ç —á—Ç–æ –º–æ–∂–Ω–æ –º–µ—Ä–∂–∏—Ç—å (–Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤)
3. –ù–∞–∂–º–∏—Ç–µ **"Merge pull request"** ‚Üí **"Confirm merge"**
4. ‚úÖ **Success!** –í–∞—à –∫–æ–¥ —Ç–µ–ø–µ—Ä—å –≤ main

### 1.5 (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é –≤–µ—Ç–∫—É

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ merge:
1. GitHub –ø—Ä–µ–¥–ª–æ–∂–∏—Ç **"Delete branch"**
2. –ú–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å `claude/project-development-plan-Wf6gO` (–æ–Ω–∞ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞)

---

## –®–∞–≥ 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ

### 2.1 –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª

–ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (Linux/Mac/Windows):

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤
cd ~/Projects  # –∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –ø–∞–ø–∫–∞
```

### 2.2 –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
git clone https://github.com/spqr-86/safety-incident-analyzer.git

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd safety-incident-analyzer
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
Cloning into 'safety-incident-analyzer'...
remote: Enumerating objects: 150, done.
remote: Counting objects: 100% (150/150), done.
remote: Compressing objects: 100% (95/95), done.
remote: Total 150 (delta 45), reused 120 (delta 35)
Receiving objects: 100% (150/150), 250.00 KiB | 1.00 MiB/s, done.
Resolving deltas: 100% (45/45), done.
```

### 2.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—ã –Ω–∞ main

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –Ω–∞ –≤–µ—Ç–∫–µ main
git branch

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
# * main
```

### 2.4 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
ls -la

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
# - tests/dataset.csv (41 –≤–æ–ø—Ä–æ—Å)
# - eval/
# - scripts/
# - src/
# - DEVELOPMENT_PLAN.md
# - LOCAL_SETUP.md
# –∏ –¥—Ä.
```

---

## –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 3.1 –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
# –°–æ–∑–¥–∞–π—Ç–µ venv
python3 -m venv venv

# –ï—Å–ª–∏ python3 –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:
# python -m venv venv
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
–°–æ–∑–¥–∞—Å—Ç—Å—è –ø–∞–ø–∫–∞ venv/ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
```

### 3.2 –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**–ù–∞ Linux/Mac:**
```bash
source venv/bin/activate
```

**–ù–∞ Windows (CMD):**
```cmd
venv\Scripts\activate.bat
```

**–ù–∞ Windows (PowerShell):**
```powershell
venv\Scripts\Activate.ps1
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**
–ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è `(venv)`:
```
(venv) user@computer:~/safety-incident-analyzer$
```

### 3.3 –û–±–Ω–æ–≤–∏—Ç–µ pip

```bash
pip install --upgrade pip
```

### 3.4 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (–∑–∞–π–º–µ—Ç 2-5 –º–∏–Ω—É—Ç)
pip install -r requirements.txt
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
Collecting langchain==0.3.7
Collecting langchain-community==0.3.5
Collecting langchain-openai==0.2.8
...
Successfully installed langchain-0.3.7 langchain-community-0.3.5 ...
```

### 3.5 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
pip list | grep -E "langchain|pytest|streamlit"

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
# langchain                 0.3.7
# langchain-community       0.3.5
# langchain-openai          0.2.8
# pytest                    7.x.x
# streamlit                 1.46.x
```

---

## –®–∞–≥ 4: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ .env —Ñ–∞–π–ª–∞

### 4.1 –°–æ–∑–¥–∞–π—Ç–µ .env –∏–∑ —à–∞–±–ª–æ–Ω–∞

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω
cp .env.example .env
```

### 4.2 –û—Ç–∫—Ä–æ–π—Ç–µ .env –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ù–∞ Linux/Mac:**
```bash
nano .env
# –∏–ª–∏
vim .env
# –∏–ª–∏
code .env  # –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω VS Code
```

**–ù–∞ Windows:**
```cmd
notepad .env
```

### 4.3 –ó–∞–ø–æ–ª–Ω–∏—Ç–µ API –∫–ª—é—á–∏

**–í–∞—Ä–∏–∞–Ω—Ç 1: –¢–æ–ª—å–∫–æ OpenAI** (–ø—Ä–æ—â–µ –≤—Å–µ–≥–æ)

–ó–∞–º–µ–Ω–∏—Ç–µ –≤ `.env`:
```env
# –ë—ã–ª–æ:
LLM_PROVIDER=gigachat
MODEL_NAME=GigaChat
OPENAI_API_KEY=YOUR_OPENAI_KEY_HERE

# –°—Ç–∞–ª–æ:
LLM_PROVIDER=openai
MODEL_NAME=gpt-4o-mini
OPENAI_API_KEY=sk-proj-–≤–∞—à-–Ω–∞—Å—Ç–æ—è—â–∏–π-–∫–ª—é—á-–∑–¥–µ—Å—å
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å OpenAI –∫–ª—é—á:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://platform.openai.com/api-keys
2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π)
3. –ù–∞–∂–º–∏—Ç–µ **"Create new secret key"**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk-proj-...`)
5. –í—Å—Ç–∞–≤—å—Ç–µ –≤ .env

**–í–∞—Ä–∏–∞–Ω—Ç 2: GigaChat + OpenAI**

```env
LLM_PROVIDER=gigachat
MODEL_NAME=GigaChat
GIGACHAT_CREDENTIALS=–≤–∞—à-–≥–∏–≥–∞—á–∞—Ç-—Ç–æ–∫–µ–Ω

OPENAI_API_KEY=sk-proj-–≤–∞—à-openai-–∫–ª—é—á

EMBEDDING_PROVIDER=openai
EMBEDDING_MODEL_NAME=text-embedding-3-small
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å GigaChat —Ç–æ–∫–µ–Ω:**
1. https://developers.sber.ru/studio/workspaces
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü–æ–ª—É—á–∏—Ç–µ credentials (—Ç–æ–∫–µ–Ω)

### 4.4 –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª

**–í nano:** `Ctrl+O` ‚Üí `Enter` ‚Üí `Ctrl+X`
**–í vim:** `:wq` ‚Üí `Enter`
**–í notepad:** `File` ‚Üí `Save`

### 4.5 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ .env —Å–æ–∑–¥–∞–Ω

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω
ls -la .env

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–±–µ–∑ –≤—ã–≤–æ–¥–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤)
cat .env | grep -E "^LLM_PROVIDER|^MODEL_NAME" | head -5
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
LLM_PROVIDER=openai
MODEL_NAME=gpt-4o-mini
```

---

## –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### 5.1 Unit —Ç–µ—Å—Ç—ã (–±–µ–∑ API –∫–ª—é—á–µ–π)

–≠—Ç–æ –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã, –Ω–µ —Ç—Ä–µ–±—É—é—Ç API –∫–ª—é—á–µ–π:

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤
pytest tests/test_retrieval_metrics.py -v
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
tests/test_retrieval_metrics.py::TestHitRate::test_hit_found PASSED       [10%]
tests/test_retrieval_metrics.py::TestHitRate::test_hit_not_found PASSED  [20%]
tests/test_retrieval_metrics.py::TestMRR::test_mrr_first_position PASSED [30%]
tests/test_retrieval_metrics.py::TestMRR::test_mrr_second_position PASSED [40%]
...
==================== 15 passed in 0.8s ====================
```

‚úÖ **–ï—Å–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ - –æ—Ç–ª–∏—á–Ω–æ!**

### 5.2 Demo –º–µ—Ç—Ä–∏–∫ (–±–µ–∑ API –∫–ª—é—á–µ–π)

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –º–µ—Ç—Ä–∏–∫:

```bash
python scripts/demo_metrics.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
========================================
–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø RETRIEVAL –ú–ï–¢–†–ò–ö
========================================

–°—Ü–µ–Ω–∞—Ä–∏–π 1: –•–æ—Ä–æ—à–∏–π –ø–æ–∏—Å–∫
Retrieved: ['doc_1', 'doc_5', 'doc_3', 'doc_7', 'doc_2']
Relevant:  ['doc_1', 'doc_2', 'doc_3']

‚úÖ Hit Rate @ 5: 1.00 (–Ω–∞–π–¥–µ–Ω —Ö–æ—Ç—è –±—ã 1 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π)
‚úÖ Precision @ 5: 0.60 (3 –∏–∑ 5 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã)
‚úÖ Recall @ 5: 1.00 (–≤—Å–µ 3 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –Ω–∞–π–¥–µ–Ω—ã)
...
```

### 5.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ dataset

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤
wc -l tests/dataset.csv

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: 42 (1 –∑–∞–≥–æ–ª–æ–≤–æ–∫ + 41 –≤–æ–ø—Ä–æ—Å)
```

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–µ—Ä–≤—ã–µ 3 –≤–æ–ø—Ä–æ—Å–∞
head -4 tests/dataset.csv
```

---

## –®–∞–≥ 6: Evaluation —Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É—é—Ç API –∫–ª—é—á–∏)

### 6.1 –ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞ (5 –≤–æ–ø—Ä–æ—Å–æ–≤)

–≠—Ç–æ —Ç–µ—Å—Ç —á—Ç–æ API –∫–ª—é—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:

```bash
python eval/run_full_evaluation.py --limit 5
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è dataset (–ø–µ—Ä–≤—ã–µ 5 –≤–æ–ø—Ä–æ—Å–æ–≤)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è LLM
3. –û—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–∞ (Faithfulness, Citation Quality, etc.)
4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `benchmarks/results_history.jsonl`

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
Loading dataset from tests/dataset.csv
Loaded 5 questions

Evaluating question 1/5: –ö—Ç–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç –æ–±—É—á–µ–Ω–∏–µ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ê...
  ‚úÖ Faithfulness: 0.95
  ‚úÖ Citation Rate: 1.00
  ‚úÖ Correctness: 8.5/10

Evaluating question 2/5: –ö–∞–∫–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤–∏–¥—ã –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π...
  ‚úÖ Faithfulness: 0.92
  ‚úÖ Citation Rate: 1.00
  ‚úÖ Correctness: 9.0/10

...

==========================================
–ê–ì–†–ï–ì–ò–†–û–í–ê–ù–ù–´–ï –ú–ï–¢–†–ò–ö–ò (5 –≤–æ–ø—Ä–æ—Å–æ–≤)
==========================================
Mean Faithfulness: 0.89
Mean Citation Rate: 0.96
Mean Correctness: 8.2/10
==========================================
```

### 6.2 –ü–æ–ª–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ (41 –≤–æ–ø—Ä–æ—Å)

**–í–ê–ñ–ù–û:** –≠—Ç–æ –∑–∞–π–º–µ—Ç 10-20 –º–∏–Ω—É—Ç –∏ —Å—Ç–æ–∏—Ç ~$1-2 (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏)

```bash
python eval/run_full_evaluation.py
```

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ **—Ä–µ–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–∑—é–º–µ!**

### 6.3 –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
tail -1 benchmarks/results_history.jsonl | python -m json.tool

# –ò–ª–∏ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º–æ:
python -c "
import json
with open('benchmarks/results_history.jsonl', 'r') as f:
    result = json.loads(f.readlines()[-1])

print('=' * 50)
print('–†–ï–ó–£–õ–¨–¢–ê–¢–´ EVALUATION')
print('=' * 50)
print(f\"Dataset size: {result['dataset_size']} questions\")
print(f\"Faithfulness: {result['aggregate_metrics']['mean_faithfulness_score']:.2%}\")
print(f\"Citation Rate: {result['aggregate_metrics']['citation_rate']:.2%}\")
print(f\"Correctness: {result['aggregate_metrics']['mean_correctness_score']:.1f}/10\")
print('=' * 50)
"
```

**–≠—Ç–∏ —Ü–∏—Ñ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Ä–µ–∑—é–º–µ!** üéâ

---

## –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫

```bash
python scripts/check_target_metrics.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
========================================
–ü–†–û–í–ï–†–ö–ê –¶–ï–õ–ï–í–´–• –ú–ï–¢–†–ò–ö
========================================

‚úÖ mean_correctness_score: 8.2 (target: 8.0)
‚úÖ mean_faithfulness_score: 0.89 (target: 0.90) ‚ö†Ô∏è  –±–ª–∏–∑–∫–æ
‚úÖ citation_rate: 0.96 (target: 0.95)

–°—Ç–∞—Ç—É—Å: 2/3 –º–µ—Ç—Ä–∏–∫ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã
========================================
```

---

## –®–∞–≥ 8: (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø—É—Å–∫ Streamlit UI

### 8.1 –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã:

```bash
# –ü–æ–ª–æ–∂–∏—Ç–µ –≤–∞—à–∏ PDF/DOCX —Ñ–∞–π–ª—ã –≤ source_docs/
mkdir -p source_docs
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã...

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é
python index.py
```

### 8.2 –ó–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
streamlit run app.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8501

---

## ‚úÖ Checklist

–û—Ç–º–µ—Ç—å—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —à–∞–≥–∏:

- [ ] **–®–∞–≥ 1**: Pull Request —Å–æ–∑–¥–∞–Ω –∏ —Å–º–µ—Ä–∂–µ–Ω –≤ main
- [ ] **–®–∞–≥ 2**: –ü—Ä–æ–µ–∫—Ç —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] **–®–∞–≥ 3**: Python –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] **–®–∞–≥ 4**: .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω API –∫–ª—é—á–∞–º–∏
- [ ] **–®–∞–≥ 5**: Unit —Ç–µ—Å—Ç—ã –∑–∞–ø—É—â–µ–Ω—ã –∏ –ø—Ä–æ—à–ª–∏ ‚úÖ
- [ ] **–®–∞–≥ 6**: Evaluation –∑–∞–ø—É—â–µ–Ω–∞ (—Ö–æ—Ç—è –±—ã –Ω–∞ 5 –≤–æ–ø—Ä–æ—Å–∞—Ö)
- [ ] **–®–∞–≥ 7**: –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- [ ] **–®–∞–≥ 8**: (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Streamlit UI –∑–∞–ø—É—â–µ–Ω

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "git clone" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ git —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
git --version

# –ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
# Ubuntu/Debian: sudo apt install git
# Mac: brew install git
# Windows: —Å–∫–∞—á–∞–π—Ç–µ —Å https://git-scm.com
```

### –ü—Ä–æ–±–ª–µ–º–∞: "python3 not found"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ python
python --version

# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.11+
# Ubuntu: sudo apt install python3.11
# Mac: brew install python@3.11
# Windows: https://www.python.org/downloads/
```

### –ü—Ä–æ–±–ª–µ–º–∞: "pip install" –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û–±–Ω–æ–≤–∏—Ç–µ pip
pip install --upgrade pip setuptools wheel

# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞
pip install -r requirements.txt
```

### –ü—Ä–æ–±–ª–µ–º–∞: Unit —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pytest
pip install pytest pytest-cov --upgrade

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
pytest tests/test_retrieval_metrics.py -v --tb=short
```

### –ü—Ä–æ–±–ª–µ–º–∞: "OpenAI API key invalid"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk-proj-...`)
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ .env –Ω–µ—Ç –∫–∞–≤—ã—á–µ–∫ –≤–æ–∫—Ä—É–≥ –∫–ª—é—á–∞:
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: `OPENAI_API_KEY=sk-proj-abc123`
   - ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: `OPENAI_API_KEY="sk-proj-abc123"`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ https://platform.openai.com/usage
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á –µ—Å–ª–∏ —Å—Ç–∞—Ä—ã–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: Evaluation –æ—á–µ–Ω—å –¥–æ–ª–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –º–æ–¥–µ–ª—å
# –í .env –∑–∞–º–µ–Ω–∏—Ç–µ:
MODEL_NAME=gpt-4o-mini  # –≤–º–µ—Å—Ç–æ gpt-4

# –ò–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤
python eval/run_full_evaluation.py --limit 10
```

---

## üéì –î–ª—è —Ä–µ–∑—é–º–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–æ–∑—å–º–∏—Ç–µ —Ü–∏—Ñ—Ä—ã –∏–∑ evaluation:

```bash
tail -1 benchmarks/results_history.jsonl | python -m json.tool | grep -E "faithfulness|citation"
```

–ò –æ–±–Ω–æ–≤–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:

**–ë—ã–ª–æ (–Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–µ):**
```
–í–Ω–µ–¥—Ä–∏–ª LLM-as-a-Judge –ø–∞–π–ø–ª–∞–π–Ω, –¥–æ—Å—Ç–∏–≥–Ω—É–≤ 89% Faithfulness –∏ 95% Citation Rate
```

**–°—Ç–∞–ª–æ (—Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏):**
```
–í–Ω–µ–¥—Ä–∏–ª LLM-as-a-Judge –ø–∞–π–ø–ª–∞–π–Ω —Å –æ—Ü–µ–Ω–∫–æ–π –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º golden dataset
(41 –≤–æ–ø—Ä–æ—Å, 3 —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏), –¥–æ—Å—Ç–∏–≥–Ω—É–≤ [–í–ê–®–ê_–¶–ò–§–†–ê]% Faithfulness –∏
[–í–ê–®–ê_–¶–ò–§–†–ê]% Citation Rate. –ù–∞—Å—Ç—Ä–æ–∏–ª CI/CD –≤ GitHub Actions —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º
–∑–∞–ø—É—Å–∫–æ–º 11 –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–º PR.
```

---

**–£—Å–ø–µ—Ö–æ–≤! üöÄ**

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã - —Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª Troubleshooting –∏–ª–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞ –ø–æ–º–æ—â—å—é.
